## v0.4.0

### Highlights (EN)

- Add `clipal update`: self-update from GitHub Releases with `checksums.txt` SHA256 verification; Windows uses a helper to replace an in-use `.exe`.
- Fix SSE “hang” scenarios: fail over to the next provider when an upstream produces no response body bytes for `upstream_idle_timeout` (default `3m`).
- Improve shutdown robustness: avoid misleading “all providers failed” logs when the request context is already canceled; harden config watcher shutdown concurrency.

### 亮点 (中文)

- 新增 `clipal update`：从 GitHub Releases 自更新，并使用 `checksums.txt` 做 SHA256 校验；Windows 通过 helper 进程自动替换占用中的 `.exe`。
- 修复 SSE 卡死场景：上游在 `upstream_idle_timeout`（默认 `3m`）内没有任何 body 字节时自动切换到下一个 provider。
- 停机与并发健壮性增强：请求已取消时不再产生误导性的 “all providers failed” 日志；配置热重载 watcher 的 stop 逻辑更安全。

### Notes

- `clipal update` 默认使用 `lansespirit/Clipal` 的 `/releases/latest`；预发布版本（如 `v0.4.0-rc.1`）不会成为 `latest`。
- Windows 更新可能需要确保没有其他进程仍在占用 `clipal.exe`（例如 service/task 正在运行）。

